<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy New Year with Love</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Arial', sans-serif;
            background: linear-gradient(135deg, #0c0c2e 0%, #1a1a3e 30%, #2d1b3e 70%, #3d1b4e 100%);
            color: #fff;
            min-height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* Main container */
        .container {
            position: relative;
            z-index: 10;
            text-align: center;
            padding: 3rem;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 25px;
            box-shadow: 
                0 0 50px rgba(255, 105, 180, 0.3),
                inset 0 0 30px rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            max-width: 850px;
            margin: 2rem;
            border: 1px solid rgba(255, 105, 180, 0.2);
            animation: containerFloat 8s ease-in-out infinite;
        }
        
        @keyframes containerFloat {
            0%, 100% { transform: translateY(0) rotate(0.5deg); }
            50% { transform: translateY(-10px) rotate(-0.5deg); }
        }
        
        h1 {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(45deg, #ff69b4, #ff1493, #ff69b4);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 30px rgba(255, 105, 180, 0.4);
            font-weight: 800;
            letter-spacing: 1px;
        }
        
        .year {
            font-size: 6rem;
            font-weight: 900;
            color: #ff69b4;
            text-shadow: 
                0 0 30px rgba(255, 105, 180, 0.8),
                0 0 60px rgba(255, 20, 147, 0.6);
            margin: 1.5rem 0;
            animation: yearGlow 3s ease-in-out infinite alternate;
        }
        
        @keyframes yearGlow {
            0% { 
                transform: scale(1); 
                text-shadow: 0 0 30px rgba(255, 105, 180, 0.8);
            }
            100% { 
                transform: scale(1.05); 
                text-shadow: 0 0 50px rgba(255, 105, 180, 1),
                             0 0 80px rgba(255, 20, 147, 0.7);
            }
        }
        
        .message {
            font-size: 1.6rem;
            margin-bottom: 3rem;
            line-height: 1.7;
            color: #f0e6ff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Read Message Button */
        .read-message-btn {
            padding: 1.2rem 3rem;
            font-size: 1.4rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: bold;
            background: linear-gradient(45deg, #ff69b4, #ff1493);
            color: white;
            box-shadow: 
                0 10px 20px rgba(255, 105, 180, 0.3),
                0 0 30px rgba(255, 20, 147, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .read-message-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff1493, #ff69b4);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.4s;
        }
        
        .read-message-btn:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 
                0 15px 30px rgba(255, 105, 180, 0.5),
                0 0 40px rgba(255, 20, 147, 0.5);
        }
        
        .read-message-btn:hover::before {
            opacity: 1;
        }
        
        .read-message-btn:active {
            transform: translateY(-3px) scale(1.02);
        }
        
        .read-message-btn i {
            animation: heartBeat 1.5s infinite;
        }
        
        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        .signature {
            margin-top: 3rem;
            color: rgba(255, 255, 255, 0.6);
            font-size: 1rem;
            font-style: italic;
        }
        
        /* Love Letter Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(15px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.8s ease;
        }
        
        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }
        
        .love-letter {
            background: linear-gradient(135deg, rgba(255, 240, 245, 0.98) 0%, rgba(255, 228, 236, 0.98) 100%);
            color: #5a2a5a;
            width: 90%;
            max-width: 750px;
            max-height: 85vh;
            border-radius: 25px;
            box-shadow: 
                0 25px 60px rgba(0, 0, 0, 0.7),
                0 0 0 2px rgba(255, 105, 180, 0.4),
                inset 0 0 30px rgba(255, 255, 255, 0.9);
            position: relative;
            transform: scale(0.9) translateY(50px);
            opacity: 0;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.8s;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .modal-overlay.active .love-letter {
            transform: scale(1) translateY(0);
            opacity: 1;
        }
        
        .love-letter::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #ff69b4, #ff1493, #ff69b4);
            z-index: 2;
        }
        
        .love-letter-header {
            padding: 2rem 3rem 1.5rem;
            border-bottom: 2px dashed rgba(255, 105, 180, 0.3);
            background: rgba(255, 255, 255, 0.9);
            flex-shrink: 0;
        }
        
        .love-letter h2 {
            color: #ff1493;
            font-size: 2.5rem;
            text-align: center;
            font-weight: 800;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 0.5rem;
            letter-spacing: 1px;
        }
        
        .letter-date {
            text-align: center;
            color: #ff69b4;
            font-style: italic;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }
        
        .letter-content-wrapper {
            flex: 1;
            overflow-y: auto;
            padding: 0 3rem;
            position: relative;
        }
        
        /* Custom scrollbar for the letter */
        .letter-content-wrapper::-webkit-scrollbar {
            width: 8px;
        }
        
        .letter-content-wrapper::-webkit-scrollbar-track {
            background: rgba(255, 105, 180, 0.1);
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .letter-content-wrapper::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #ff69b4, #ff1493);
            border-radius: 10px;
        }
        
        .letter-content-wrapper::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, #ff1493, #ff4081);
        }
        
        .letter-content {
            font-size: 1.3rem;
            line-height: 1.9;
            text-align: left;
            padding: 2.5rem 0;
        }
        
        .letter-content p {
            margin-bottom: 1.8rem;
            position: relative;
            padding-left: 1.5rem;
        }
        
        .letter-content p::before {
            content: '❤';
            position: absolute;
            left: -5px;
            top: 0;
            color: #ff69b4;
            font-size: 1rem;
            opacity: 0.7;
        }
        
        .love-letter-footer {
            padding: 1.5rem 3rem 2.5rem;
            border-top: 2px dashed rgba(255, 105, 180, 0.3);
            background: rgba(255, 255, 255, 0.9);
            flex-shrink: 0;
        }
        
        .letter-signature {
            text-align: right;
            font-style: italic;
            font-size: 1.5rem;
            color: #ff1493;
            font-weight: 700;
            margin-top: 1rem;
            position: relative;
            display: inline-block;
            padding-right: 50px;
            align-self: flex-end;
        }
        
        .letter-signature::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ff1493'%3E%3Cpath d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/%3E%3C/svg%3E");
            background-size: contain;
            opacity: 0.8;
        }
        
        .close-modal {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: rgba(255, 105, 180, 0.9);
            border: none;
            font-size: 1.5rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            z-index: 101;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .close-modal:hover {
            transform: rotate(90deg) scale(1.1);
            background: rgba(255, 20, 147, 0.9);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        /* Floating hearts inside the modal */
        .modal-heart {
            position: absolute;
            font-size: 1.2rem;
            color: rgba(255, 105, 180, 0.7);
            pointer-events: none;
            z-index: 1;
            animation: floatInModal 4s linear infinite;
        }
        
        @keyframes floatInModal {
            0% {
                transform: translateY(100px) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            90% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Hearts and fireworks containers */
        #fireworksCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        #heartsContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }
        
        .heart {
            position: absolute;
            pointer-events: none;
            z-index: 2;
            opacity: 0;
            filter: drop-shadow(0 0 10px rgba(255, 105, 180, 0.7));
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 2rem;
                margin: 1rem;
            }
            
            h1 {
                font-size: 2.8rem;
            }
            
            .year {
                font-size: 4rem;
            }
            
            .message {
                font-size: 1.3rem;
            }
            
            .read-message-btn {
                padding: 1rem 2rem;
                font-size: 1.2rem;
            }
            
            .love-letter {
                width: 95%;
                max-height: 90vh;
            }
            
            .love-letter-header,
            .letter-content-wrapper,
            .love-letter-footer {
                padding: 1.5rem;
            }
            
            .love-letter h2 {
                font-size: 2rem;
            }
            
            .letter-content {
                font-size: 1.1rem;
                padding: 1.5rem 0;
            }
            
            .letter-signature {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- Fireworks Canvas -->
    <canvas id="fireworksCanvas"></canvas>
    
    <!-- Hearts Container -->
    <div id="heartsContainer"></div>
    
    <!-- Main Content -->
    <div class="container">
        <h1>Happy New Year, My Love</h1>
        <div class="year" id="currentYear">2025</div>
        <p class="message">
            As the clock strikes midnight and a new year begins, my heart is filled with gratitude for you. 
            May this year bring us closer, fill our lives with beautiful moments, and strengthen the love we share.
        </p>
        
        <button class="read-message-btn" id="readMessageBtn">
            <i class="fas fa-heart"></i> Read My Love Letter
        </button>
        
        <div class="signature">
            With all my love, forever and always
        </div>
    </div>
    
    <!-- Love Letter Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <button class="close-modal" id="closeModal">
            <i class="fas fa-times"></i>
        </button>
        
        <div class="love-letter">
            <div class="love-letter-header">
                <h2>My Dearest Love,</h2>
                <div class="letter-date">New Year's Eve, 2024</div>
            </div>
            
            <div class="letter-content-wrapper">
                <div class="letter-content">
                    <p>
                        As the old year fades and a new one dawns, I find myself reflecting on all the beautiful moments we've shared. 
                        Each memory with you is a treasure I hold close to my heart.
                    </p>
                    
                    <p>
                        This past year has shown me what true love means. Through every challenge and every joy, your presence has been my anchor and my inspiration. 
                        Your laughter is my favorite sound, your smile my favorite sight, and your love my greatest blessing.
                    </p>
                    
                    <p>
                        I remember the way your eyes sparkle when you talk about your dreams, the warmth of your hand in mine on cold evenings, 
                        and the way you make even ordinary moments feel magical. You've brought colors to my world that I never knew existed.
                    </p>
                    
                    <p>
                        As we step into this new year, I promise to cherish you more with each passing day. 
                        I vow to be your comfort in difficult times, your partner in adventure, and your biggest supporter in all your dreams.
                    </p>
                    
                    <p>
                        I promise to listen more carefully, love more deeply, and appreciate you more fully. 
                        I promise to grow with you, learn with you, and build a future that exceeds our wildest dreams.
                    </p>
                    
                    <p>
                        May this year bring us countless sunsets to watch together, endless laughter to share, and a love that grows deeper with every moment. 
                        I look forward to creating new memories, building our dreams, and loving you more than I did the day before.
                    </p>
                    
                    <p>
                        I dream of mornings waking up beside you, evenings spent talking about everything and nothing, 
                        and all the little moments in between that make life worth living. With you, every day feels like a new beginning.
                    </p>
                    
                    <p>
                        No matter what this new year brings, know that my love for you is constant and eternal. 
                        You are my forever, my always, and my greatest happiness. Through all the seasons of life, my heart will always find its home in you.
                    </p>
                    
                    <p>
                        As the fireworks light up the sky tonight, each burst reminds me of the spark you brought into my life. 
                        And as the clock strikes twelve, I'll be counting my blessings, with you at the very top of the list.
                    </p>
                    
                    <p>
                        Here's to a new year of love, growth, and beautiful moments together. May our journey continue to be filled with wonder, 
                        and may our love story keep writing itself in the stars.
                    </p>
                </div>
            </div>
            
            <div class="love-letter-footer">
                <div class="letter-signature">
                    With all my heart, now and always,<br>
                    Forever Yours
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize variables
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        const heartsContainer = document.getElementById('heartsContainer');
        const currentYearElement = document.getElementById('currentYear');
        const readMessageBtn = document.getElementById('readMessageBtn');
        const modalOverlay = document.getElementById('modalOverlay');
        const closeModal = document.getElementById('closeModal');
        const loveLetter = document.querySelector('.love-letter');
        
        // Set current year
        const currentYear = new Date().getFullYear() + 1;
        currentYearElement.textContent = currentYear;
        
        // Set canvas dimensions
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // Smoothing variables
        let lastTime = 0;
        const fps = 60;
        const interval = 1000 / fps;
        
        // Arrays for particles
        let fireworks = [];
        let particles = [];
        
        // Colors for romantic theme
        const romanticColors = [
            '#ff69b4', '#ff1493', '#ff6bc9', '#ff8ed4', 
            '#e91e63', '#c2185b', '#ad1457', '#880e4f'
        ];
        
        // Particle class for smooth animation
        class Particle {
            constructor(x, y, vx, vy, color, size, life, gravity = 0.05, fade = true) {
                this.x = x;
                this.y = y;
                this.vx = vx;
                this.vy = vy;
                this.color = color;
                this.size = size;
                this.life = life;
                this.maxLife = life;
                this.gravity = gravity;
                this.fade = fade;
                this.alpha = 1;
            }
            
            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.vy += this.gravity;
                this.life--;
                
                if (this.fade) {
                    this.alpha = this.life / this.maxLife;
                }
                
                return this.life > 0;
            }
            
            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }
        
        // Firework class
        class Firework {
            constructor(x, y, targetX, targetY) {
                this.x = x;
                this.y = y;
                this.startX = x;
                this.startY = y;
                this.targetX = targetX;
                this.targetY = targetY;
                this.speed = 2 + Math.random() * 1.5;
                this.angle = Math.atan2(targetY - y, targetX - x);
                this.distance = Math.hypot(targetX - x, targetY - y);
                this.traveled = 0;
                this.trail = [];
                this.color = romanticColors[Math.floor(Math.random() * romanticColors.length)];
                this.exploded = false;
            }
            
            update() {
                if (this.exploded) return false;
                
                const prevX = this.x;
                const prevY = this.y;
                
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed;
                
                this.traveled = Math.hypot(this.x - this.startX, this.y - this.startY);
                
                // Add trail particles
                this.trail.push(new Particle(
                    this.x, this.y, 
                    (Math.random() - 0.5) * 0.5, 
                    (Math.random() - 0.5) * 0.5,
                    this.color, 
                    1 + Math.random() * 2, 
                    15, 
                    0.01, 
                    true
                ));
                
                // Limit trail length
                if (this.trail.length > 8) {
                    this.trail.shift();
                }
                
                // Check if reached target
                if (this.traveled >= this.distance * 0.95) {
                    this.explode();
                    return false;
                }
                
                return true;
            }
            
            explode() {
                this.exploded = true;
                
                // Create explosion particles
                const particleCount = 80 + Math.floor(Math.random() * 40);
                for (let i = 0; i < particleCount; i++) {
                    const angle = Math.random() * Math.PI * 2;
                    const speed = 1 + Math.random() * 3;
                    
                    particles.push(new Particle(
                        this.x, this.y,
                        Math.cos(angle) * speed,
                        Math.sin(angle) * speed,
                        this.color,
                        1.5 + Math.random() * 2.5,
                        50 + Math.random() * 50,
                        0.05,
                        true
                    ));
                }
                
                // Create heart from explosion 30% of the time
                if (Math.random() < 0.3) {
                    createHeart(this.x, this.y, true);
                }
            }
            
            draw() {
                // Draw trail
                for (const particle of this.trail) {
                    particle.draw();
                }
                
                // Draw firework body
                ctx.save();
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw glow
                const gradient = ctx.createRadialGradient(
                    this.x, this.y, 0,
                    this.x, this.y, 15
                );
                gradient.addColorStop(0, this.color + '80');
                gradient.addColorStop(1, 'transparent');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 15, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }
        
        // Heart creation with smooth animation
        function createHeart(x, y, fromExplosion = false) {
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.innerHTML = '❤️';
            
            // Random romantic color
            const color = romanticColors[Math.floor(Math.random() * 4)];
            heart.style.color = color;
            
            // Random size
            const size = 25 + Math.random() * 35;
            heart.style.fontSize = `${size}px`;
            
            // Starting position
            heart.style.left = `${x}px`;
            heart.style.top = `${y}px`;
            
            heartsContainer.appendChild(heart);
            
            // Animation properties
            const startX = x;
            const startY = y;
            const angle = Math.random() * Math.PI * 2;
            const speed = fromExplosion ? 2 + Math.random() * 3 : 0.5 + Math.random();
            const velocity = {
                x: Math.cos(angle) * speed,
                y: Math.sin(angle) * speed - (fromExplosion ? 4 : 2)
            };
            
            let life = 120 + Math.random() * 120;
            const rotation = (Math.random() - 0.5) * 2;
            let rotationAngle = 0;
            
            // Animation loop for heart
            function animateHeart() {
                // Apply physics
                velocity.y += 0.05; // Gravity
                velocity.x *= 0.99; // Air resistance
                
                // Update position
                x += velocity.x;
                y += velocity.y;
                
                // Update rotation
                rotationAngle += rotation;
                
                // Update life and opacity
                life--;
                const opacity = Math.min(1, life / 150);
                
                // Apply to DOM element
                heart.style.left = `${x}px`;
                heart.style.top = `${y}px`;
                heart.style.opacity = opacity;
                heart.style.transform = `rotate(${rotationAngle}deg)`;
                
                // Continue or remove
                if (life > 0 && opacity > 0.05) {
                    requestAnimationFrame(animateHeart);
                } else {
                    heart.remove();
                }
            }
            
            // Start animation
            requestAnimationFrame(animateHeart);
        }
        
        // Create floating hearts inside the modal
        function createModalHearts() {
            if (!modalOverlay.classList.contains('active')) return;
            
            const modalRect = loveLetter.getBoundingClientRect();
            const heartCount = 3 + Math.floor(Math.random() * 3);
            
            for (let i = 0; i < heartCount; i++) {
                const heart = document.createElement('div');
                heart.className = 'modal-heart';
                heart.innerHTML = '❤️';
                
                // Random position within modal
                const left = Math.random() * (modalRect.width - 30);
                const size = 15 + Math.random() * 20;
                const delay = Math.random() * 2;
                const duration = 3 + Math.random() * 2;
                
                heart.style.left = `${left}px`;
                heart.style.fontSize = `${size}px`;
                heart.style.animationDelay = `${delay}s`;
                heart.style.animationDuration = `${duration}s`;
                
                // Random color
                const colors = ['#ff69b4', '#ff1493', '#ff4081', '#e91e63'];
                heart.style.color = colors[Math.floor(Math.random() * colors.length)];
                
                loveLetter.appendChild(heart);
                
                // Remove heart after animation completes
                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.remove();
                    }
                }, (duration + delay) * 1000);
            }
        }
        
        // Launch firework with smooth trajectory
        function launchFirework() {
            const startX = Math.random() * canvas.width;
            const startY = canvas.height;
            const targetX = canvas.width * 0.2 + Math.random() * canvas.width * 0.6;
            const targetY = canvas.height * 0.1 + Math.random() * canvas.height * 0.3;
            
            fireworks.push(new Firework(startX, startY, targetX, targetY));
        }
        
        // Smooth animation loop
        function animate(timestamp) {
            requestAnimationFrame(animate);
            
            // Control frame rate for smoother animation
            const delta = timestamp - lastTime;
            if (delta < interval) return;
            lastTime = timestamp - (delta % interval);
            
            // Clear canvas with fade effect
            ctx.fillStyle = 'rgba(12, 12, 46, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Update and draw all particles
            for (let i = particles.length - 1; i >= 0; i--) {
                if (particles[i].update()) {
                    particles[i].draw();
                } else {
                    particles.splice(i, 1);
                }
            }
            
            // Update and draw fireworks
            for (let i = fireworks.length - 1; i >= 0; i--) {
                if (fireworks[i].update()) {
                    fireworks[i].draw();
                } else {
                    fireworks.splice(i, 1);
                }
            }
        }
        
        // Initialize animation
        requestAnimationFrame(animate);
        
        // Start with some fireworks
        setTimeout(() => {
            launchFirework();
            launchFirework();
        }, 500);
        
        setTimeout(() => {
            launchFirework();
            launchFirework();
            launchFirework();
        }, 1500);
        
        // Periodic fireworks
        setInterval(() => {
            if (Math.random() < 0.4 && fireworks.length < 8) {
                launchFirework();
            }
        }, 2000);
        
        // Create hearts periodically
        setInterval(() => {
            if (Math.random() < 0.3) {
                const x = Math.random() * canvas.width;
                const y = canvas.height + 50;
                createHeart(x, y);
            }
        }, 2500);
        
        // Modal controls
        readMessageBtn.addEventListener('click', () => {
            modalOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Create extra hearts when opening the letter
            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    const x = Math.random() * canvas.width;
                    const y = canvas.height + 50;
                    createHeart(x, y);
                }, i * 100);
            }
            
            // Start creating modal hearts
            const modalHeartInterval = setInterval(createModalHearts, 1500);
            
            // Store interval ID to clear later
            modalOverlay.dataset.heartInterval = modalHeartInterval;
        });
        
        closeModal.addEventListener('click', () => {
            modalOverlay.classList.remove('active');
            document.body.style.overflow = 'auto';
            
            // Clear modal hearts interval
            if (modalOverlay.dataset.heartInterval) {
                clearInterval(parseInt(modalOverlay.dataset.heartInterval));
            }
        });
        
        // Close modal when clicking outside
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
                modalOverlay.classList.remove('active');
                document.body.style.overflow = 'auto';
                
                // Clear modal hearts interval
                if (modalOverlay.dataset.heartInterval) {
                    clearInterval(parseInt(modalOverlay.dataset.heartInterval));
                }
            }
        });
        
        // Close modal with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && modalOverlay.classList.contains('active')) {
                modalOverlay.classList.remove('active');
                document.body.style.overflow = 'auto';
                
                // Clear modal hearts interval
                if (modalOverlay.dataset.heartInterval) {
                    clearInterval(parseInt(modalOverlay.dataset.heartInterval));
                }
            }
        });
        
        // Add initial hearts
        for (let i = 0; i < 8; i++) {
            setTimeout(() => {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                createHeart(x, y);
            }, i * 300);
        }
    </script>
</body>
</html>